{"files":[{"id":"b5919c3f-bfeb-4623-b588-b37a96bc3dd4","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Argentina/Buenos_Aires\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"73caadb5-66d7-41a1-86f4-2d49a43c7eed","name":"Código","type":"server_js","source":"function doPost(e) {\n\n  Logger.log(JSON.stringify(e));\n  var date \u003d new Date();\n  var email \u003d e.parameter[\u0027email\u0027];\n  var fila\n\n  var ss \u003d SpreadsheetApp.openById(\u00271nsQyMS-bwCz32FwX8FD3E9MtCG1vFtUfyNxoqRPuS10\u0027);\n  var sheet \u003d ss.getSheets()[0];\n  var ratesData \u003d sheet.getRange(2, 1, sheet.getLastRow() - 1, 7).getValues() //get the values of the range\n\n  try {\n    ratesData.forEach((row, index) \u003d\u003e {\n      if (row[4] \u003d\u003d email) {\n        fila \u003d index + 2 //get the row of the match (need to add 2 to match the SS)\n      }\n    })\n\n    sheet.getRange(fila, 7).setValue(\u0027SI\u0027); //update the value\n    sheet.getRange(fila, 8).setValue(date); //update the value\n\n    var emailBody \u003d HtmlService.createTemplateFromFile(\u0027purchaseConfirmation.html\u0027);\n    // emailBody.firstName \u003d firstName;\n    var message \u003d emailBody.evaluate().getContent();\n\n    // MailApp.sendEmail({\n    //   to: email.toString(),\n    //   subject: \"Confirmación de Inscripción | XXXVII Jornadas Científicas\",\n    //   htmlBody: message\n    // });\n\n    // return json success results\n    return ContentService.createTextOutput(JSON.stringify({ result: \u0027success\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n\n\n  } catch (error) { // if error return this\n    Logger.log(error);\n    return ContentService\n      .createTextOutput(JSON.stringify({ result: \u0027error\u0027 }))\n      .setMimeType(ContentService.MimeType.JAVASCRIPT);\n  }\n}"},{"id":"161819f0-c298-49c7-8a96-31d3896f86d9","name":"purchaseConfirmation","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\n\u003chead\u003e\n  \u003cbase target\u003d\"_top\"\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n  \u003ch2\u003eXXXVII Jornadas Científicas - Hospital Santojanni\u003c/h2\u003e\n  \u003cp\u003e\u003cstrong\u003eEstimado/a\u003e,\u003c/strong\u003e\u003c/p\u003e\n  \u003cp\u003eel pago se ha procesado exitosamente!\u003c/p\u003e\n  \u003cbr\u003e\n  \u003cp\u003eYa estas inscripto a las Jornadas.\u003c/p\u003e\n  \u003cbr\u003e\n  \u003cp\u003eTe esperamos el 7, 9 y 10 de noviembre\u003c/p\u003e\n\n\u003c/body\u003e\n\n\u003c/html\u003e"}]}